#!/bin/bash

# æµ‹è¯•è„šæœ¬
echo "ğŸ§ª å¼€å§‹è¿è¡Œç»„ä»¶æµ‹è¯•..."

# è¿è¡Œç±»å‹æ£€æŸ¥
echo "ğŸ“ è¿è¡Œç±»å‹æ£€æŸ¥..."
pnpm type-check

if [ $? -ne 0 ]; then
    echo "âŒ ç±»å‹æ£€æŸ¥å¤±è´¥"
    exit 1
fi

# è¿è¡Œlintæ£€æŸ¥
echo "ğŸ” è¿è¡Œä»£ç æ£€æŸ¥..."
pnpm lint

if [ $? -ne 0 ]; then
    echo "âŒ ä»£ç æ£€æŸ¥å¤±è´¥"
    exit 1
fi

# è¿è¡Œæµ‹è¯•
echo "âš¡ è¿è¡Œå•å…ƒæµ‹è¯•..."
pnpm test:run

if [ $? -ne 0 ]; then
    echo "âŒ å•å…ƒæµ‹è¯•å¤±è´¥"
    exit 1
fi

# è¿è¡Œè¦†ç›–ç‡æµ‹è¯•
echo "ğŸ“Š ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š..."
pnpm test:coverage

if [ $? -ne 0 ]; then
    echo "âŒ è¦†ç›–ç‡æµ‹è¯•å¤±è´¥"
    exit 1
fi

echo "âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼"
echo "ğŸ“ˆ æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Šå·²ç”Ÿæˆï¼Œè¯·æŸ¥çœ‹ coverage/ ç›®å½•"
